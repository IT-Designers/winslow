<div>

  <div *ngIf="this.projects != null" class="flex-grow-row control-button-row">
    <div class="flex-grow"></div>
    <button class="create-button" mat-raised-button color="primary"
            (click)="createNewProject()">Create Project
    </button>
  </div>

  <div *ngIf="projects != null && projects.length == 0" class="none-defined-yet">
    <i>There are no projects yet</i>
  </div>

  <app-loading-info [error]="loadError ? loadError.message : null" [loading]="projects == null"></app-loading-info>


  <mat-accordion>
    <mat-expansion-panel
      *ngFor="let project of projects"
      (afterCollapse)="stopLoading(project)"
      (afterExpand)="startLoading(project)">

      <mat-expansion-panel-header>
        <mat-panel-title style="max-width: 45%; padding-right: 1em; overflow: hidden; white-space: nowrap">
          <app-state-icon #icon animation="true"></app-state-icon>
          {{project.name}}
        </mat-panel-title>
        <mat-panel-description style="overflow: hidden; white-space: nowrap; max-height: 2.2em">
          <app-tags-with-autocomplete [readonly]="true" [tags]="project.tags"></app-tags-with-autocomplete>
        </mat-panel-description>
        <mat-panel-description style="margin-left: auto">
          {{view.pauseReason}}
          <mat-progress-bar *ngIf="view.progress != null && view.isRunning()"
                            [value]="view.progress"
                            style="width: 10em; margin: auto 1em">
          </mat-progress-bar>
        </mat-panel-description>
      </mat-expansion-panel-header>

      <app-project-view #view (state)="icon.state = $event" [project]="project"></app-project-view>

    </mat-expansion-panel>
  </mat-accordion>


</div>
