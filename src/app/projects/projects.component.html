<div>
  <h1>Projects</h1>

  <div class="flex-grow-row control-button-row">
    <div class="flex-grow"></div>
    <button class="create-button" mat-raised-button color="primary"
            (click)="create()"
    >Create Project
    </button>
  </div>

  <div class="project-list-replacement">
    <i *ngIf="projects == null">
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </i>
    <i *ngIf="projects != null && projects.length == 0">There are no projects yet yet</i>
  </div>
  <mat-expansion-panel *ngFor="let project of projects" (expandedChange)="loadHistory(project, $event)">
    <mat-expansion-panel-header>
      <span style="display: flex; align-items: center">
        <app-state-icon [state]="project.state" animation="true"></app-state-icon>
        {{project.name}}
      </span>
    </mat-expansion-panel-header>
    <mat-list>
      <i *ngIf="project.history == null">
        <mat-progress-bar mode="buffer"></mat-progress-bar>
      </i>
      <i *ngIf="project.history != null && project.history.length == 0">This project has no history yet</i>
      <mat-list-item *ngFor="let entry of project.history" class="history-list-item">

        <app-state-icon [state]="entry.state"></app-state-icon>

        <p>{{toDate(entry.time)}}</p>
        <p>{{project.pipeline.stages[entry.stageIndex].name}}</p>
      </mat-list-item>
    </mat-list>
  </mat-expansion-panel>


</div>
