build:
  tags:
    - dockerbuilder
  script:
    - export TAG="${TAG:-${CI_COMMIT_TAG:-latest}}"
    - docker pull nexus.itd-intern.de/winslow/component-html:$TAG
    - docker pull nexus.itd-intern.de/winslow/component-server:$TAG
    - docker build . -t $DOCKER_REGISTRY_WINSLOW/winslow/node:$TAG
    - docker login -u $DOCKER_REGISTRY_WINSLOW_USERNAME -p $DOCKER_REGISTRY_WINSLOW_PASSWORD $DOCKER_REGISTRY_WINSLOW
    - docker push $DOCKER_REGISTRY_WINSLOW/winslow/node:$TAG
